<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  
  <mapper namespace="albumDao">

	<select id="albumAll" resultType="int">
	  		select count(*) from album 
	</select> 
	
	<select id="albumList" parameterType="pageDto" resultType="albumDto">
		select * from album
	</select>
  <select id="getbook" parameterType="int" resultType="bookDto">
  	select * from book where bookNo=#{bookNo}
  </select>
  
  <insert id="insertOk" parameterType="albumDto">
  	
  	insert into album values(albumNo=#{albumNo},memberNo=#{memberNo},albumCont=#{albumCont},albumTitle={albumTitle} )
  </insert>
	<insert id="albumIns" parameterType="bookDto">
 		insert into album (bookNo,memberId,albumTitle,albumCont,albumSysdate)
 			values(#{bookNo}, #{memberId},#{albumTitle},#{albumCont},now())	
 	</insert>
 	
 	<select id="albumNoList" parameterType="int" resultType="albumDto">
     select * from album_detail d LEFT JOIN album a ON d.albumNo = a.albumNo
         LEFT JOIN book b on b.bookNO = d.bookNo LEFT JOIN `member` m on m.memberNo = a.memberNo where a.albumNo = ${value};
   </select>
 	
 	<select id="albumLikeCheck"  parameterType="albumLikeDto" resultType="albumLikeDto">
			select * from fianlB.albumLike where memberNo = #{memberNo} and albumNo = #{albumNo}
	</select>
	
	<insert id="insertAlbumLike" parameterType="albumLikeDto" >
		insert into fianlB.albumLike values(#{memberNo},#{albumNo})
	</insert>
	
	<delete id="deleteAlbumLike" parameterType="albumLikeDto">
		DELETE FROM fianlB.albumLike WHERE memberNo = #{memberNo} AND albumNo = #{albumNo}
	</delete>
	
	<select id="likeCount" parameterType="int" resultType="int">
		select count(*) from fianlB.albumLike where albumNo = ${value}
	</select>
	
	<select id="albumCommentList" parameterType="int" resultType="albumCommentDto">
		select * from fianlB.album_comment where albumNo = #{value}
	</select>
	
  </mapper>